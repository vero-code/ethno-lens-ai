<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="description"
            content="Get started with Add-on development using JavaScript with Document Sandbox Runtime"
        />
        <meta name="keywords" content="Adobe, Express, Add-On, JavaScript, Document Sandbox Runtime" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>EthnoLens AI</title>
        <!-- Spectrum Bundle Ð¸ Express theme -->
        <script src="https://jspm.dev/@spectrum-web-components/bundle/elements.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/theme@0.40.1/express/theme-light.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/theme@0.40.1/express/scale-medium.js" type="module"></script>
        <!-- Additional components -->
         <script src="https://jspm.dev/@spectrum-web-components/field-label@0.40.1/sp-field-label.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/picker@0.40.1/sp-picker.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/menu@0.40.1/sp-menu.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/menu@0.40.1/sp-menu-item.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/textfield@0.40.1/sp-textfield.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/button@0.40.1/sp-button.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/tabs@0.40.1/sp-tabs.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/tabs@0.40.1/sp-tab.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/tabs@0.40.1/sp-tab-panel.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/progress-circle@0.40.1/sp-progress-circle.js" type="module"></script>
        <script src="https://jspm.dev/@spectrum-web-components/checkbox@0.40.1/sp-checkbox.js" type="module"></script>
        <link rel="stylesheet" href="css/style.css" />
    </head>
    <body>
        <sp-theme scale="medium" color="light" theme="express">
            <div class="addon-body">
                <h1>EthnoLens AI</h1>
                <p>Scan your design for possible cultural or symbolic issues across regions.</p>

                <sp-tabs selected="tab-analyze-image">
                    <sp-tab value="tab-scan-design" label="Design"></sp-tab>
                    <sp-tab value="tab-analyze-image" label="Image"></sp-tab>

                    <!-- Panel 1: Design -->
                    <sp-tab-panel value="tab-scan-design">
                        <div class="tab-panel-content">
                            <!-- Country Select -->
                            <sp-field-label for="countrySelect">Select country:</sp-field-label>
                            <sp-picker id="countrySelect" label="Choose a country">
                                <sp-menu-item>Loading countries...</sp-menu-item>
                            </sp-picker>
                            
                            <!-- Business Type Select -->
                            <sp-field-label for="businessType">Business type:</sp-field-label>
                            <sp-picker id="businessType" label="Choose business type">
                                <sp-menu-item>Loading business types...</sp-menu-item>
                            </sp-picker>

                            <!-- Other Business Type Input -->
                            <sp-textfield 
                                id="otherBusinessType" 
                                placeholder="Please specify your business type">
                            </sp-textfield>
                            
                            <!-- Action Buttons -->
                            <div class="button-row">
                                <sp-button id="scanDesign">Scan</sp-button>
                                <sp-button id="resetDesign">Reset</sp-button>
                            </div>

                            <!-- Score Box -->
                            <div id="scoreBox">
                                <h3>Cultural Sensitivity Score</h3>
                                <p id="scoreValue">--</p>
                            </div>

                            <!-- Result Box -->
                            <div id="resultBox">
                                <sp-progress-circle id="scanDesignSpinner" indeterminate></sp-progress-circle>
                                <div id="scanDesignContent">No issues detected yet.</div>
                            </div>

                            <!-- Premium Upsell -->
                            <div id="premiumUpsellScan">
                                <sp-button id="notifyPremiumButtonScan" variant="primary">
                                    I'm interested in Premium
                                </sp-button>
                            </div>

                            <!-- Follow-up Chat -->
                            <div id="followUpChat">
                                <h3>Ask the AI</h3>
                                <sp-textfield 
                                    id="chatInput" 
                                    multiline
                                    rows="3"
                                    placeholder="Ask a follow-up question...">
                                </sp-textfield>
                                <p class="chat-hint">
                                    Try: <em>What color would work better?</em>
                                </p>

                                <sp-button id="chatSend" variant="accent">
                                    Send
                                </sp-button>

                                <div id="chatResponse">
                                    <sp-progress-circle id="chatSpinner" indeterminate></sp-progress-circle>
                                    <div id="chatResponseContent">AI conversation not started yet.</div>
                                    <div id="chatError"></div>
                                </div>

                                <div id="premiumUpsellChat">
                                    <sp-button id="notifyPremiumButtonChat" variant="primary">
                                        I'm interested in Premium
                                    </sp-button>
                                </div>
                            </div>
                        </div>
                    </sp-tab-panel>

                    <!-- Panel 2: Image Analysis -->
                    <sp-tab-panel value="tab-analyze-image">
                        <div class="tab-panel-content">
                            <!-- Country Select -->
                            <sp-field-label for="imageCountrySelect">Select country:</sp-field-label>
                            <sp-picker id="imageCountrySelect" label="Choose a country">
                                <sp-menu-item>Loading countries...</sp-menu-item>
                            </sp-picker>

                            <!-- Business Type Select -->
                            <sp-field-label for="imageBusinessType">Business type:</sp-field-label>
                            <sp-picker id="imageBusinessType" label="Choose business type">
                                <sp-menu-item>Loading business types...</sp-menu-item>
                            </sp-picker>

                            <!-- Other Business Type Input -->
                            <sp-textfield 
                                id="imageOtherBusinessType" 
                                placeholder="Please specify your business type">
                            </sp-textfield>

                            <h3>Upload an image</h3>
                            <input type="file" id="imageUpload" accept="image/*"/>

                            <!-- Action Buttons -->
                            <div class="button-row">
                                <sp-button id="analyzeImage" variant="accent" disabled>Analyze</sp-button>
                                <sp-button id="resetImage" disabled>Reset</sp-button>
                            </div>

                            <!-- Image Preview -->
                            <img id="imagePreview" alt="Image Preview"/>

                            <!-- Result Box -->
                            <div id="imageResultBox">
                                <sp-progress-circle id="imageSpinner" indeterminate></sp-progress-circle>
                                <div id="imageResultContent">No image analyzed yet.</div>
                                <div id="imageError"></div>
                            </div>

                            <!-- Premium Upsell -->
                            <div id="premiumUpsellImage">
                                <sp-button id="notifyPremiumButtonImage" variant="primary">
                                    I'm interested in Premium
                                </sp-button>
                            </div>
                        </div>
                    </sp-tab-panel>
                </sp-tabs>

                <!-- Dev Controls -->
                <div id="devControls">
                    <sp-checkbox id="mockDataToggle">Use Mock Data</sp-checkbox>
                </div>
            </div>
        </sp-theme>

        <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
        <script type="module" src="ui/loadCountries.js"></script>
        <script type="module" src="ui/loadBusinessTypes.js"></script>
        <script type="module" src="ui/index.js"></script>
    </body>
</html>
